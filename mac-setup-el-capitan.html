<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>borborygmi</title>
    <meta name="description" content="">
    <meta name="author" content="Noah Hoffman">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="https://nhoffman.github.io/borborygmi/theme/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="https://nhoffman.github.io/borborygmi/theme/bootstrap.min.css" rel="stylesheet">
    <link href="https://nhoffman.github.io/borborygmi/theme/bootstrap.min.responsive.css" rel="stylesheet">
    <link href="https://nhoffman.github.io/borborygmi/theme/local.css" rel="stylesheet">
    <link href="https://nhoffman.github.io/borborygmi/theme/pygments.css" rel="stylesheet">

</head>

<body>

<div class="navbar">
    <div class="navbar-inner">
    <div class="container">

         <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
             <span class="icon-bar"></span>
         </a>

        <a class="brand" href="https://nhoffman.github.io/borborygmi">borborygmi</a>

        <div class="nav-collapse">
        <ul class="nav">

        </ul>
        </div>

    </div>
    </div>
</div>

<div class="container">
    <div class="content">
    <div class="row">

        <div class="span9">
  <div class='article'>
    <div class="content-title">
      <h1>Setup after clean install of El Capitan</h1>
Mon 02 November 2015 &#8212;


<em>Filed under <a href="https://nhoffman.github.io/borborygmi/category/notes.html">notes</a>;
    tags: <a href="https://nhoffman.github.io/borborygmi/tag/mac.html">mac</a></em>    </div>

    <div><div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgb619f6c">First applications</a>
<ul>
<li><a href="#org2a1f366">Developer tools</a></li>
<li><a href="#orgc8e5ad7">X11</a></li>
<li><a href="#orgb7a8436">iTerm2</a></li>
<li><a href="#org2caa704">Others</a></li>
<li><a href="#org39d9553">UW only</a></li>
</ul>
</li>
<li><a href="#org09930c5">system-level configuration</a>
<ul>
<li><a href="#org612d288">turn off spelling autocorrect</a></li>
<li><a href="#orgfe880ad">turn off spaces key shortcuts</a></li>
</ul>
</li>
<li><a href="#orgbbaa119">homebrew</a>
<ul>
<li><a href="#org626243d">packages installed using homebrew</a></li>
<li><a href="#org2c8dc98">homebrew cask</a></li>
<li><a href="#org83452da">homebrew API token</a></li>
<li><a href="#org4aa4b5d">zsh</a></li>
</ul>
</li>
<li><a href="#org52c2f67">ssh</a>
<ul>
<li><a href="#org3e8fe0a">update /System/Library/LaunchAgents/org.openbsd.ssh-agent.plist</a></li>
<li><a href="#orgea7c89c">create $ZSH_INITDIR/ssh-ask-keychain (called from start_ssh_agent.zsh)</a></li>
<li><a href="#orgc0c4656">create $ZSH_INITDIR/start_ssh_agent.zsh</a></li>
</ul>
</li>
<li><a href="#orgee36bd9">git</a></li>
<li><a href="#org4d77aa0">emacs</a></li>
<li><a href="#orgc7bf665">python</a></li>
<li><a href="#org33a8acb">R</a></li>
<li><a href="#org747bae3">mail</a></li>
<li><a href="#orge52ebf2">sshfs</a></li>
<li><a href="#orge6fad28">wkhtmltopdf</a></li>
</ul>
</div>
</div>
<p>
I had enough issues after updating to El Capitan (the inability to save my
wifi password in the system keychain was the tipping point) that I
decided to perform a clean install. Here are some notes.
</p>

<div id="outline-container-orgb619f6c" class="outline-2">
<h2 id="orgb619f6c">First applications</h2>
<div class="outline-text-2" id="text-orgb619f6c">
</div>
<div id="outline-container-org2a1f366" class="outline-3">
<h3 id="org2a1f366">Developer tools</h3>
<div class="outline-text-3" id="text-org2a1f366">
<p>
Pretty much the first thing any mac needs is the command line tools. This can be done from the command line:
</p>

<div class="org-src-container">
<pre class="src src-sh">xcode-select --install
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc8e5ad7" class="outline-3">
<h3 id="orgc8e5ad7">X11</h3>
<div class="outline-text-3" id="text-orgc8e5ad7">
<p>
Download and install Xquartz:
</p>

<div class="org-src-container">
<pre class="src src-sh">cd ~/Downloads
wget http://xquartz.macosforge.org/downloads/SL/XQuartz-2.7.8.dmg
open XQuartz-2.7.8.dmg
sudo installer -pkg /Volumes/XQuartz-2.7.8/XQuartz.pkg -target /
</pre>
</div>

<p>
Note for next time: might be worth trying to use homebrew.
</p>

<p>
X11 key bindings so that the option key is used for Meta..
</p>

<div class="org-src-container">
<pre class="src src-sh">cat &gt; ~/.Xmodmap &lt;&lt;EOF
clear Mod1
clear Mod2
keycode 63 = Mode_switch
keycode 66 = Meta_L
add Mod1 = Meta_L
add Mod2 = Mode_switch
EOF
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb7a8436" class="outline-3">
<h3 id="orgb7a8436">iTerm2</h3>
<div class="outline-text-3" id="text-orgb7a8436">
<p>
Update a few settings.
</p>

<p>
Preferences &#x2013;&gt; Profiles &#x2013;&gt; Keys and do these things:
</p>
<ul class="org-ul">
<li>select "Left/right option key acts as": +Esc</li>
<li>+ &#x2013;&gt; Keyboard shortcut "OPT+&lt;left arrow&gt;": Send Escape sequence "b"</li>
<li>+ &#x2013;&gt; Keyboard shortcut "OPT+&lt;right arrow&gt;": Send Escape sequence "f"</li>
</ul>

<p>
Default appearance:
</p>

<ul class="org-ul">
<li>Preferences &#x2013;&gt; Profiles &#x2013;&gt; Colors &#x2013;&gt; Load Presets &#x2013;&gt; Light Background</li>
<li>Preferences &#x2013;&gt; Profiles &#x2013;&gt; Text &#x2013;&gt; Change Font &#x2013;&gt; 14 point</li>
</ul>
</div>
</div>

<div id="outline-container-org2caa704" class="outline-3">
<h3 id="org2caa704">Others</h3>
<div class="outline-text-3" id="text-org2caa704">
<ul class="org-ul">
<li>Dropbox</li>
<li>SizeUp - <a href="http://www.irradiatedsoftware.com/">http://www.irradiatedsoftware.com/</a> (license in Dropbox/software_licenses)</li>
<li>MacTex - download from <a href="http://tug.org/mactex/">http://tug.org/mactex/</a>
<a href="http://mirror.ctan.org/systems/mac/mactex/MacTeX.pkg">http://mirror.ctan.org/systems/mac/mactex/MacTeX.pkg</a></li>
<li>HipChat client</li>
<li>Chrome</li>
<li>Dash 2 (App store)</li>
</ul>
</div>
</div>

<div id="outline-container-org39d9553" class="outline-3">
<h3 id="org39d9553">UW only</h3>
<div class="outline-text-3" id="text-org39d9553">
<ul class="org-ul">
<li>Sophos antivirus: <a href="https://softy.cac.washington.edu/sophos/for-staff/">https://softy.cac.washington.edu/sophos/for-staff/</a></li>
<li>Junos Pulse (SSL VPN): <a href="https://networks.uwmedicine.org/content/sslvpn-frequently-asked-questions-14">https://networks.uwmedicine.org/content/sslvpn-frequently-asked-questions-14</a></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org09930c5" class="outline-2">
<h2 id="org09930c5">system-level configuration</h2>
<div class="outline-text-2" id="text-org09930c5">
</div>
<div id="outline-container-org612d288" class="outline-3">
<h3 id="org612d288">turn off spelling autocorrect</h3>
<div class="outline-text-3" id="text-org612d288">
<p>
System Preferences &#x2013;&gt; Language &amp; Text &#x2013;&gt; Text tab &#x2013;&gt; unselect "Correct spelling automatically"
</p>
</div>
</div>
<div id="outline-container-orgfe880ad" class="outline-3">
<h3 id="orgfe880ad">turn off spaces key shortcuts</h3>
<div class="outline-text-3" id="text-orgfe880ad">
<p>
System Preferences &#x2013;&gt; Keyboard &#x2013;&gt; Keyboard Shortcuts &#x2013;&gt; unselect C+{&lt;-,-&gt;}
</p>
</div>
</div>
</div>

<div id="outline-container-orgbbaa119" class="outline-2">
<h2 id="orgbbaa119">homebrew</h2>
<div class="outline-text-2" id="text-orgbbaa119">
<p>
Note that El Capitan introduced <a href="https://en.wikipedia.org/wiki/System_Integrity_Protection">System Integrity Protection (SIP)</a>, which may need to be temporarily disabled during homebrew installation. See <a href="https://github.com/Homebrew/homebrew/blob/master/share/doc/homebrew/El_Capitan_and_Homebrew.md">https://github.com/Homebrew/homebrew/blob/master/share/doc/homebrew/El_Capitan_and_Homebrew.md</a>
</p>

<div class="org-src-container">
<pre class="src src-sh">ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
brew doctor
</pre>
</div>

<p>
If it becomes necessary to fix permissions:
</p>

<div class="org-src-container">
<pre class="src src-sh">sudo chown -R $(whoami) /usr/local
</pre>
</div>
</div>

<div id="outline-container-org626243d" class="outline-3">
<h3 id="org626243d">packages installed using homebrew</h3>
<div class="outline-text-3" id="text-org626243d">
<div class="org-src-container">
<pre class="src src-sh">brew install homebrew/dupes/tcl-tk &amp;&amp; \
brew install aspell &amp;&amp; \
brew install autojump &amp;&amp; \
brew install berkeley-db4 &amp;&amp; \
brew install gcc &amp;&amp; \
brew install git &amp;&amp; \
brew install gpg &amp;&amp; \
brew install graphviz &amp;&amp; \
brew install htop-osx &amp;&amp; \
brew install latex2rtf &amp;&amp; \
brew install openssh &amp;&amp; \
brew install pandoc &amp;&amp; \
brew install pkg-config &amp;&amp; \
brew install readline &amp;&amp; \
brew install sqlite &amp;&amp; \
brew install tmux &amp;&amp; \
brew install tree &amp;&amp; \
brew install wget &amp;&amp; \
brew install zsh
</pre>
</div>
</div>
</div>

<div id="outline-container-org2c8dc98" class="outline-3">
<h3 id="org2c8dc98">homebrew cask</h3>
<div class="outline-text-3" id="text-org2c8dc98">
<p>
Command line installer for desktop applications. See <a href="https://caskroom.github.io">https://caskroom.github.io</a>
</p>

<div class="org-src-container">
<pre class="src src-sh">brew tap caskroom/cask
</pre>
</div>

<p>
Install some applications
</p>

<div class="org-src-container">
<pre class="src src-sh">brew cask install java
</pre>
</div>
</div>
</div>

<div id="outline-container-org83452da" class="outline-3">
<h3 id="org83452da">homebrew API token</h3>
<div class="outline-text-3" id="text-org83452da">
<p>
Apparently lots of requests to GutHub via homebrew can hit a rate limit. There's a higher limit if you create an API token. See <a href="https://gist.github.com/christopheranderton/8644743">https://gist.github.com/christopheranderton/8644743</a>
</p>

<p>
Here's the url for the token creation dialog:
</p>

<p>
<a href="https://github.com/settings/tokens/new?scopes=&amp;description=Homebrew">https://github.com/settings/tokens/new?scopes=&amp;description=Homebrew</a>
</p>

<p>
Make sure that all 'scopes' are unchecked. Once you generate the token, add to your shell profile:
</p>

<pre class="example">
export HOMEBREW_GITHUB_API_TOKEN=token_here
</pre>
</div>
</div>

<div id="outline-container-org4aa4b5d" class="outline-3">
<h3 id="org4aa4b5d">zsh</h3>
<div class="outline-text-3" id="text-org4aa4b5d">
<p>
Install zsh with Homebrew above
</p>

<p>
Change shell to zsh
</p>

<div class="org-src-container">
<pre class="src src-sh">sudo -s
echo /usr/local/bin/zsh &gt;&gt; /etc/shells
exit
chsh -s /usr/local/bin/zsh $USER
</pre>
</div>

<p>
zsh init files are in Dropbox/zsh
</p>

<div class="org-src-container">
<pre class="src src-sh">cat &gt; ~/.zshenv &lt;&lt;EOF
. ~/Dropbox/zsh/zstartup
EOF
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org52c2f67" class="outline-2">
<h2 id="org52c2f67">ssh</h2>
<div class="outline-text-2" id="text-org52c2f67">
<p>
After installing homebrew's openssh on El Capitan, ssh-agent no longer
seemed to work (in the sense that after using ssh-add to cache a
passphrase, I still got a system prompt when trying to ssh). This
seemed to be fixed by the instructions I found at the url below (my
version is functionally the same but uses PlistBuddy to edit the
plist):
</p>

<p>
<a href="https://coderwall.com/p/qdwcpg/using-the-latest-ssh-from-homebrew-on-osx">https://coderwall.com/p/qdwcpg/using-the-latest-ssh-from-homebrew-on-osx</a>
</p>
</div>

<div id="outline-container-org3e8fe0a" class="outline-3">
<h3 id="org3e8fe0a">update /System/Library/LaunchAgents/org.openbsd.ssh-agent.plist</h3>
<div class="outline-text-3" id="text-org3e8fe0a">
<div class="org-src-container">
<pre class="src src-sh">sudo /usr/libexec/PlistBuddy /System/Library/LaunchAgents/org.openbsd.ssh-agent.plist&lt;&lt;EOF
Delete :ProgramArguments
Add :ProgramArguments array
Add :ProgramArguments: string /usr/local/bin/ssh-agent
Add :ProgramArguments: string -D
Add :ProgramArguments: string -t 1d
Save
Exit
EOF
</pre>
</div>

<p>
This should change the original value of <code>ProgramArguments</code>:
</p>

<pre class="example" id="orgb8b571c">
&lt;key&gt;ProgramArguments&lt;/key&gt;
&lt;array&gt;
	&lt;string&gt;/usr/bin/ssh-agent&lt;/string&gt;
	&lt;string&gt;-l&lt;/string&gt;
&lt;/array&gt;
</pre>

<p>
to
</p>

<pre class="example" id="orgc765e44">
&lt;key&gt;ProgramArguments&lt;/key&gt;
&lt;array&gt;
	&lt;string&gt;/usr/local/bin/ssh-agent&lt;/string&gt;
	&lt;string&gt;-D&lt;/string&gt;
	&lt;string&gt;-t 1d&lt;/string&gt;
&lt;/array&gt;
</pre>

<p>
Now restart the service
</p>

<div class="org-src-container">
<pre class="src src-sh">launchctl unload /System/Library/LaunchAgents/org.openbsd.ssh-agent.plist
launchctl load -w /System/Library/LaunchAgents/org.openbsd.ssh-agent.plist
launchctl start org.openbsd.ssh-agent
</pre>
</div>
</div>
</div>

<div id="outline-container-orgea7c89c" class="outline-3">
<h3 id="orgea7c89c">create $ZSH_INITDIR/ssh-ask-keychain (called from start_ssh_agent.zsh)</h3>
<div class="outline-text-3" id="text-orgea7c89c">
<div class="org-src-container">
<pre class="src src-sh">cat ~/Dropbox/zsh/ssh-ask-keychain
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc0c4656" class="outline-3">
<h3 id="orgc0c4656">create $ZSH_INITDIR/start_ssh_agent.zsh</h3>
<div class="outline-text-3" id="text-orgc0c4656">
<p>
(either as a file sourced from .zshrc, or as a code block in a login script)
</p>

<div class="org-src-container">
<pre class="src src-sh">cat ~/Dropbox/zsh/ssh_environ.zsh
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgee36bd9" class="outline-2">
<h2 id="orgee36bd9">git</h2>
<div class="outline-text-2" id="text-orgee36bd9">
<pre class="example">
git config --global user.name "My Name"
git config --global user.email me@email.com
</pre>
</div>
</div>

<div id="outline-container-org4d77aa0" class="outline-2">
<h2 id="org4d77aa0">emacs</h2>
<div class="outline-text-2" id="text-org4d77aa0">
<p>
Install emacs24 binary from <a href="http://emacsformacosx.com/">http://emacsformacosx.com/</a>
</p>

<p>
<a href="http://emacsformacosx.com/emacs-builds/Emacs-24.5-1-universal.dmg">http://emacsformacosx.com/emacs-builds/Emacs-24.5-1-universal.dmg</a>
</p>

<p>
Check out my .emacs.d
</p>

<div class="org-src-container">
<pre class="src src-sh">cd ~
git clone git@github.com:nhoffman/.emacs.d.git
git submodule init
git submodule update
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc7bf665" class="outline-2">
<h2 id="orgc7bf665">python</h2>
<div class="outline-text-2" id="text-orgc7bf665">
<p>
Use homebrew - see
<a href="https://github.com/Homebrew/homebrew/blob/master/share/doc/homebrew/Homebrew-and-Python.md">https://github.com/Homebrew/homebrew/blob/master/share/doc/homebrew/Homebrew-and-Python.md</a>
</p>

<p>
Run <code>brew info python</code> for required and optional dependencies
(installed above).
</p>

<div class="org-src-container">
<pre class="src src-sh">brew install python --with-berkeley-db4 --with-tcl-tk
brew linkapps python
pip install -U pip
pip install -U setuptools
pip install -U virtualenv
</pre>
</div>

<p>
Install some python packages using homebrew - these are time consuming to install otherwise.
</p>

<div class="org-src-container">
<pre class="src src-sh">brew install homebrew/python/numpy
</pre>
</div>

<p>
Install some other packages to the system using pip.
</p>

<p>
For elpy:
</p>

<div class="org-src-container">
<pre class="src src-sh">pip install -r &lt;(curl https://raw.githubusercontent.com/jorgenschaefer/elpy/master/requirements.txt)
</pre>
</div>

<p>
ansible
</p>

<div class="org-src-container">
<pre class="src src-sh">sudo mkdir /usr/share/ansible
sudo chown -R $(whoami) /usr/share/ansible
pip install ansible
</pre>
</div>

<p>
Others
</p>

<div class="org-src-container">
<pre class="src src-sh">pip install csvkit
pip install reportlab
pip install scons
pip install jinja2
</pre>
</div>
</div>
</div>

<div id="outline-container-org33a8acb" class="outline-2">
<h2 id="org33a8acb">R</h2>
<div class="outline-text-2" id="text-org33a8acb">
<p>
Really doubling down on homebrew this time around:
</p>

<div class="org-src-container">
<pre class="src src-sh">brew tap homebrew/science
brew install r
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh">R --slave &lt;&lt; EOF
packages &lt;- c("ape", "sqldf", "ROCR", "lattice", "RSQLite", "latticeExtra", "argparse", "data.table")
install.packages(packages, repos="http://cran.fhcrc.org/", dependencies=TRUE, clean=TRUE)
EOF
</pre>
</div>
</div>
</div>

<div id="outline-container-org747bae3" class="outline-2">
<h2 id="org747bae3">mail</h2>
<div class="outline-text-2" id="text-org747bae3">
<p>
<a href="http://www.washington.edu/itconnect/connect/email/uw-email/configuring/os-x-mail6/">http://www.washington.edu/itconnect/connect/email/uw-email/configuring/os-x-mail6/</a>
</p>
</div>
</div>

<div id="outline-container-orge52ebf2" class="outline-2">
<h2 id="orge52ebf2">sshfs</h2>
<div class="outline-text-2" id="text-orge52ebf2">
<p>
Provided by the project <a href="http://osxfuse.github.io/">http://osxfuse.github.io/</a> - the links below
are for binaries provided as installers.
</p>

<div class="org-src-container">
<pre class="src src-sh">cd ~/Downloads
wget http://sourceforge.net/projects/osxfuse/files/osxfuse-2.8.2/osxfuse-2.8.2.dmg
wget https://github.com/osxfuse/sshfs/releases/download/osxfuse-sshfs-2.5.0/sshfs-2.5.0.pkg
</pre>
</div>
</div>
</div>

<div id="outline-container-orge6fad28" class="outline-2">
<h2 id="orge6fad28">wkhtmltopdf</h2>
<div class="outline-text-2" id="text-orge6fad28">
<div class="org-src-container">
<pre class="src src-sh">cd ~/Downloads
wget 'http://wkhtmltopdf.googlecode.com/files/wkhtmltopdf.dmg'
open wkhtmltopdf.dmg
cp -r /Volumes/wkhtmltopdf/wkhtmltopdf.app /Applications
</pre>
</div>

<p>
Now create an alias:
</p>

<div class="org-src-container">
<pre class="src src-sh">alias wkhtmltopdf='/Applications/wkhtmltopdf.app/Contents/MacOS/wkhtmltopdf'
</pre>
</div>
</div>
</div>
</div>

    <hr>

  </div>
        </div>

        <div class="span3">

            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header">
                Site
                </li>

                <li><a href="https://nhoffman.github.io/borborygmi/">Archives</a>
                <li><a href="https://nhoffman.github.io/borborygmi/tags.html">Tags</a>
                <li><a href="https://nhoffman.github.io/borborygmi/" rel="alternate">Atom feed</a></li>
            </ul>
            </div>


            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header">
                Categories
                </li>

                <li><a href="https://nhoffman.github.io/borborygmi/category/lectures.html">lectures</a></li>
                <li><a href="https://nhoffman.github.io/borborygmi/category/notes.html">notes</a></li>
                <li><a href="https://nhoffman.github.io/borborygmi/category/org-mode.html">org-mode</a></li>
                <li><a href="https://nhoffman.github.io/borborygmi/category/projects.html">projects</a></li>
                <li><a href="https://nhoffman.github.io/borborygmi/category/python.html">python</a></li>
                <li><a href="https://nhoffman.github.io/borborygmi/category/sql.html">sql</a></li>
            </ul>
            </div>


            <div class="well" style="padding: 8px 0; background-color: #FBFBFB;">
            <ul class="nav nav-list">
                <li class="nav-header">
                Links
                </li>

                <li><a href="https://github.com/nhoffman">GitHub account</a></li>
                <li><a href="https://github.com/nhoffman/borborygmi">site source</a></li>
            </ul>
            </div>



        </div>     </div>     </div> 
<footer>
<br />
<p><a href="https://nhoffman.github.io/borborygmi">borborygmi</a> &copy; Noah Hoffman 2025</p>
</footer>

</div> <!-- /container -->


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-16886766-2', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>